# CLAUDE.md — リポジトリ作業ガイドライン

> このファイルは Claude Code がこのリポジトリで作業する際に**常に参照する**ルール定義である。
> すべての指示は**厳守**すること。判断に迷った場合はこのファイルに立ち戻る。

---

## プロジェクト概要

- **目的**: テスト・学習用リポジトリ
- **内容**: Gitチートシートなどの参考資料、およびWebアプリケーションの実装

---

## リポジトリ構成

```
/
├── memo/             # 参考資料（Gitチートシートなど）
├── notepad-app/      # メモ帳アプリ（Java Servlet + H2 + HTML/CSS/JS の3層構造）
│   └── docs/         # 処理フロー図などのドキュメント
├── CLAUDE.md         # 本ファイル（作業ガイドライン）
└── README.md         # プロジェクト説明
```

---

## 構成ルール

> **目的**: リポジトリの秩序を保ち、どこに何があるか常に追跡可能にする。

### 新規アプリ作成時

1. リポジトリ**直下**に専用フォルダを作成する（ネストしない）
2. ソースコード・設定ファイル・ドキュメントはすべてそのフォルダ内に格納する

```
# ✅ 正しい配置
/todo-app/
/calculator/

# ❌ 誤った配置（サブフォルダにネストしている）
/apps/todo-app/
/projects/calculator/
```

### CLAUDE.md の自動更新（必須）

以下の操作を行った場合、**同じコミット内で**本ファイルの「リポジトリ構成」セクションを更新すること:

- フォルダの追加・削除・リネーム
- ファイル構成の大幅な変更

### アーキテクチャドキュメント（必須）

アプリを**新規作成**または**大幅に変更**した場合、以下を作成・更新する:

- **配置場所**: `<アプリフォルダ>/docs/architecture.html`
- **必須コンテンツ**:
  - アーキテクチャ概要図
  - 各操作（CRUD等）のリクエスト → 処理 → レスポンスのフロー
  - ファイルと役割の対応表
- **スタイル要件**: 各層・コンポーネントを**色分け**して視覚的に区別する

---

## コーディングルール

> **目的**: プロジェクト全体でスタイルを統一し、可読性と保守性を確保する。

### 全言語共通（最優先）

| ルール | 詳細 |
|---|---|
| ファイル末尾 | **必ず改行を1つ**入れる |
| 末尾の空白 | **必ず削除**する |
| コメント言語 | **日本語**で記述する |

---

### HTML

- DOCTYPE: `<!DOCTYPE html>` を必ず記述する
- インデント: **スペース2つ**
- `<html>` タグに `lang` 属性を指定する（例: `lang="ja"`）
- タグ名・属性名は**小文字**で記述する
- 属性値は**ダブルクォート**で囲む
- セマンティックHTML要素を適切に使用する（`<header>`, `<main>`, `<section>`, `<article>`, `<footer>` など）

```html
<!-- ✅ 正しい例 -->
<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>タイトル</title>
  </head>
  <body>
    <header class="site-header">
      <h1>見出し</h1>
    </header>
    <main>
      <section class="content-area">
        <p>本文</p>
      </section>
    </main>
  </body>
</html>

<!-- ❌ 誤った例 -->
<HTML Lang='ja'>
<DIV class="header">
  <H1>見出し</H1>
</DIV>
```

---

### CSS

- インデント: **スペース2つ**
- クラス名: **ケバブケース**（`my-class-name`）
- セレクタ: **クラスセレクタを使用**する。IDセレクタ（`#id`）でのスタイリングは**禁止**
- プロパティ順序: **アルファベット順**に記述する
- 色の値: **小文字の16進数**（`#fff`, `#333333`）
- マジックナンバー: **禁止**。CSS変数（`var(--spacing-md)`）を使用する

```css
/* ✅ 正しい例 */
.content-card {
  background-color: #fff;
  border-radius: var(--radius-sm);
  color: #333;
  padding: var(--spacing-md);
}

/* ❌ 誤った例: IDセレクタ、マジックナンバー、順序不定、大文字色 */
#card {
  padding: 16px;
  color: #333;
  background-color: #FFF;
  border-radius: 4px;
}
```

---

### JavaScript

- インデント: **スペース2つ**
- 文字列: **シングルクォート**（`'文字列'`）
- 文末: **セミコロン必須**
- 変数宣言: `const` を優先 → 再代入が必要な場合のみ `let` を使用。**`var` は禁止**
- 比較演算子: **厳密等価**（`===`, `!==`）のみ使用。**`==`, `!=` は禁止**
- 関数: **アロー関数を優先**する
- 命名規則:
  - 変数・関数 → `camelCase`（例: `myVariable`, `getUserName`）
  - クラス → `PascalCase`（例: `UserService`）
  - 定数 → `UPPER_SNAKE_CASE`（例: `MAX_RETRY_COUNT`）

```javascript
// ✅ 正しい例
const MAX_RETRY_COUNT = 3;

const fetchUserData = async (userId) => {
  const response = await fetch(`/api/users/${userId}`);
  if (response.status === 200) {
    return response.json();
  }
  return null;
};

// ❌ 誤った例: var、==、ダブルクォート、function宣言
var maxRetry = 3;
function fetchUserData(userId) {
  var response = fetch("/api/users/" + userId);
  if (response.status == 200) {
    return response.json()
  }
}
```

---

### Java

- インデント: **スペース4つ**
- アクセス修飾子: **必ず明示**する（省略しない）
- クラス構成: **1クラス1ファイル**。ファイル名はクラス名と一致させる
- `@Override`: 該当するメソッドには**必ず付与**する
- 命名規則:
  - 変数・メソッド → `camelCase`（例: `userName`, `getUserName()`）
  - クラス → `PascalCase`（例: `NoteServlet`）
  - 定数 → `UPPER_SNAKE_CASE`（例: `MAX_COUNT`）
  - パッケージ → `all.lowercase`（例: `com.example.myapp`）

```java
// ✅ 正しい例
package com.example.notepad;

public class NoteServlet extends HttpServlet {

    private static final int MAX_COUNT = 100;

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp)
            throws ServletException, IOException {
        // リクエストを処理する
    }
}

// ❌ 誤った例: アクセス修飾子省略、@Override欠落、命名違反
class noteServlet extends HttpServlet {
    static final int max_count = 100;

    void doGet(HttpServletRequest req, HttpServletResponse resp) {
    }
}
```

---

## 対話ルール

| ルール | 適用範囲 |
|---|---|
| **日本語**で対話する | Claudeとのすべてのやり取り |
| **日本語**で記述する | コミットメッセージ、ドキュメント、コードコメント |

---

## Markdownドキュメント記述ルール

> **目的**: CLAUDE.md・仕様書・READMEなどのMarkdownファイルを、AIが正確に解釈・実行できる形式で統一する。
> Markdownファイルの新規作成・編集時は、**必ず以下のルールに従う**こと。

### 文書構造

- **冒頭に文書の役割と重要度を明記**する。ファイルの最初に「このファイルは何か」「どの程度厳守すべきか」を1〜2行で宣言する

```markdown
<!-- ✅ 正しい例 -->
> このファイルは○○のルール定義である。すべての指示は**厳守**すること。

<!-- ❌ 誤った例: 役割や重要度が不明 -->
# メモ
いろいろなルールをまとめます。
```

- **見出し階層を正しく使う**。`#` → `##` → `###` の順に使用し、階層を飛ばさない

```markdown
<!-- ✅ 正しい例 -->
## セクション名
### サブセクション名

<!-- ❌ 誤った例: ##を飛ばしている -->
# セクション名
### サブセクション名
```

- **各セクションの冒頭に目的（なぜこのルールがあるか）を記載**する。`>` 引用ブロックで記述する

```markdown
<!-- ✅ 正しい例 -->
## コーディングルール
> **目的**: プロジェクト全体でスタイルを統一し、可読性を確保する。

<!-- ❌ 誤った例: 目的がなく、ルールの意図が不明 -->
## コーディングルール
- インデントはスペース2つ
```

- **セクション間は `---`（水平線）で区切る**

### ルールの記述方法

- **曖昧な表現は禁止**。「〜を避ける」「〜が望ましい」ではなく、「**〜は禁止**」「**〜は必須**」と断定する

```markdown
<!-- ✅ 正しい例 -->
- IDセレクタでのスタイリングは**禁止**
- `@Override` アノテーションは**必ず付与**する

<!-- ❌ 誤った例: 曖昧で判断に迷う -->
- IDセレクタはなるべく避ける
- `@Override` を付けることが望ましい
```

- **具体的な値・パス・コマンドを明記**する。抽象的な指示は禁止

```markdown
<!-- ✅ 正しい例 -->
- 配置場所: `<アプリフォルダ>/docs/architecture.html`
- インデント: **スペース4つ**

<!-- ❌ 誤った例: 具体性がない -->
- 適切な場所にドキュメントを配置する
- 適切なインデントを使用する
```

- **条件と動作をセットで書く**。「〜の場合は、〜すること」の形式にする

```markdown
<!-- ✅ 正しい例 -->
フォルダ構成を変更した場合、**同じコミット内で** CLAUDE.md の「リポジトリ構成」を更新すること

<!-- ❌ 誤った例: いつ実行すべきか不明 -->
CLAUDE.md は適宜更新する
```

### コード例の記載

- **✅正しい例と❌誤った例を必ず併記**する。片方だけでは不十分
- ❌の例には**何が誤りかをコメントで説明**する

````markdown
<!-- ✅ 正しい記載 -->
```javascript
// ✅ 正しい例
const userName = 'Alice';

// ❌ 誤った例: var使用、ダブルクォート
var userName = "Alice";
```

<!-- ❌ 誤った記載: 正しい例だけで、何を避けるべきか不明 -->
```javascript
const userName = 'Alice';
```
````

### 表・リストの使い分け

- **2項目以上の対応関係**がある場合は**表形式**を使用する

```markdown
<!-- ✅ 正しい例: 対応関係が明確 -->
| ルール | 詳細 |
|---|---|
| ファイル末尾 | **必ず改行を1つ**入れる |
| 末尾の空白 | **必ず削除**する |

<!-- ❌ 誤った例: 対応関係が散文に埋もれている -->
ファイルの末尾には改行を入れてください。また、末尾の空白は削除してください。
```

- **手順・順序がある場合は番号付きリスト**、**順序がない場合は箇条書き**を使用する

### チェックリスト

- **ファイル末尾に作業完了チェックリスト**を設ける。`- [ ]` 形式で、作業後の自己検証項目を列挙する

### ディレクトリ構成の記載

- **tree形式のコードブロック**で記述する。各項目に `#` コメントで説明を付ける

```markdown
<!-- ✅ 正しい例 -->
​```
/
├── src/          # ソースコード
│   ├── index.js  # エントリーポイント
│   └── utils/    # ユーティリティ
└── README.md     # プロジェクト説明
​```

<!-- ❌ 誤った例: 構造が読み取りにくい -->
- src/ にソースコードがあります
  - index.js がエントリーポイントです
  - utils/ にユーティリティがあります
```

---

## 作業完了チェックリスト

コード生成・ファイル変更を行った後、コミット前に以下を確認すること:

- [ ] コーディングルール（インデント、命名、禁止事項）に違反していないか
- [ ] ファイル末尾に改行があるか、末尾空白がないか
- [ ] コメント・ドキュメントが日本語で記述されているか
- [ ] フォルダ構成を変更した場合、CLAUDE.md の「リポジトリ構成」を更新したか
- [ ] アプリを新規作成・大幅変更した場合、`docs/architecture.html` を作成・更新したか
- [ ] Markdownファイルを作成・編集した場合、「Markdownドキュメント記述ルール」に従っているか（目的の記載、✅❌例の併記、曖昧表現の排除など）